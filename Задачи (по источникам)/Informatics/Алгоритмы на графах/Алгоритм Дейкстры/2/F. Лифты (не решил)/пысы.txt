Задачу не сдал. Основная проблема - затраты памяти. Дано всего 64Мб, а я использую сильно больше.
Надо решить!