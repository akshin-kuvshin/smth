См. задача "Последовательность из 0 и 1", т.к. условия одинаковые. В задаче "Взрывоопасность" входные данные урезаны сильнее, поэтому можно исключить использование длинной арифметики.