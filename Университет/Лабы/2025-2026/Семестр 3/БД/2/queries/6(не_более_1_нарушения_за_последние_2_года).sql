SELECT
    Фамилия + ' ' + Имя & (' ' + Отчество) AS ФИО,
    COUNT(П.Номер_протокола) AS [Кол-во нарушений]
FROM
   (ВОДИТЕЛЬ AS ВД
    LEFT JOIN СУБЪЕКТ_ПРАВОНАРУШЕНИЯ AS СП ON ВД.СНИЛС = СП.СНИЛС)
    LEFT JOIN ПРОТОКОЛ AS П ON СП.Номер_протокола = П.Номер_протокола
WHERE Дата IS NULL
   OR DATEDIFF('yyyy', Дата, DATE()) < 2
GROUP BY
    ВД.СНИЛС,
    Фамилия,
    Имя,
    Отчество
HAVING COUNT(П.Номер_протокола) <= 1
ORDER BY 2, 1;

